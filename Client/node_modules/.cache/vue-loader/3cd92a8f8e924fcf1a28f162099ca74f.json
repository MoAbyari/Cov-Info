{"remainingRequest":"/Users/m67abyari/cov-info/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/m67abyari/cov-info/src/components/LeafletMap.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/m67abyari/cov-info/src/components/LeafletMap.vue","mtime":1631195563125},{"path":"/Users/m67abyari/cov-info/node_modules/cache-loader/dist/cjs.js","mtime":1630730682042},{"path":"/Users/m67abyari/cov-info/node_modules/babel-loader/lib/index.js","mtime":1630730686592},{"path":"/Users/m67abyari/cov-info/node_modules/cache-loader/dist/cjs.js","mtime":1630730682042},{"path":"/Users/m67abyari/cov-info/node_modules/vue-loader/lib/index.js","mtime":1630730687738}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAibGVhZmxldC9kaXN0L2xlYWZsZXQuY3NzIjsKaW1wb3J0IHsgYXBpIH0gZnJvbSAnLi4vaGVscGVycy9oZWxwZXJzJzsKaW1wb3J0IEwgZnJvbSAibGVhZmxldCI7CmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7CmNvbnN0IGdldENvbG9yID0gKGQpID0+IHsKICAgICAgICAgICAgICAgIHJldHVybiAgZCA+IDEwMDAgPyAnIzNEMjgwNycgOgogICAgICAgICAgICAgICAgICAgICAgICBkID4gNTAwICA/ICcjYmQwMDI2JyA6CiAgICAgICAgICAgICAgICAgICAgICAgIGQgPiAxMDAgID8gJyNmYjZhNGEnIDoKICAgICAgICAgICAgICAgICAgICAgICAgZCA+IDUwICAgPyAnI2ZlOTkyOScgOgogICAgICAgICAgICAgICAgICAgICAgICBkID4gOSAgID8gICAneWVsbG93JyA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcjZjBmMGYwJzsKICAgICAgICB9OwoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogIk1hcCIsCiAgICBkYXRhKCkgewogICAgICAgIHJldHVybnsKICAgICAgICAgICAgTlNXR2VvSnNvbjogW10sCiAgICAgICAgICAgIGRhaWx5Q2FzZXNJblN0YXRlOiBbXSwKICAgICAgICAgICAgY2VudGVyOiBbLTMzLjg1NTUsIDE1MS4xMTU1XSwKICAgICAgICB9CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIGdldENvbG9yKGQpIHsKICAgICAgICAgICAgICAgIHJldHVybiAgZCA+IDEwMDAgPyAnIzNEMjgwNycgOgogICAgICAgICAgICAgICAgICAgICAgICBkID4gNTAwICA/ICcjYmQwMDI2JyA6CiAgICAgICAgICAgICAgICAgICAgICAgIGQgPiAxMDAgID8gJyNmYjZhNGEnIDoKICAgICAgICAgICAgICAgICAgICAgICAgZCA+IDUwICAgPyAnI2ZlOTkyOScgOgogICAgICAgICAgICAgICAgICAgICAgICBkID4gMTAgICA/ICAgJ3llbGxvdycgOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnI2YwZjBmMCc7CiAgICAgICAgfSwKICAgICAgICBzdHlsZU1hcChmZWF0dXJlKXsKICAgICAgICAgICAgaWYgKGZlYXR1cmU/LnByb3BlcnRpZXMuTEdBX0NPREUxOSkgewogICAgICAgICAgICAgICAgY29uc3QgbGdhQ29kZSA9IGZlYXR1cmUucHJvcGVydGllcy5MR0FfQ09ERTE5OwogICAgICAgICAgICAgICAgY29uc3QgbnVtYmVyT2ZDYXNlc0J5TGdhID0gXy5maW5kKHRoaXMuZGFpbHlDYXNlc0luU3RhdGUsIHtsZ2FfY29kZTogbGdhQ29kZX0pOwogICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnN0IHRvdGFsQ2FzZXMgPSBudW1iZXJPZkNhc2VzQnlMZ2E/LnRvdGFsX2Nhc2VzIHx8IDA7CiAgICAgICAgICAgICAgICBjb25zdCBjb2xvciA9IHRoaXMuZ2V0Q29sb3IodG90YWxDYXNlcyk7CiAgICAgICAgICAgICAgICByZXR1cm4geyAKICAgICAgICAgICAgICAgICAgICBjb2xvcjogImJsYWNrIiwKICAgICAgICAgICAgICAgICAgICBmaWxsQ29sb3I6IGNvbG9yLAogICAgICAgICAgICAgICAgICAgIHdlaWdodDogMSwKICAgICAgICAgICAgICAgICAgICAvLyBvcGFjaXR5OiAwLjUsCiAgICAgICAgICAgICAgICAgICAgZmlsbE9wYWNpdHk6IDEKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4geyBjb2xvcjogIndoaXRlIiB9OwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBvbkVhY2hGZWF0dXJlKGZlYXR1cmUsIGxheWVyKSB7CiAgICAgICAgICAgIGlmIChmZWF0dXJlPy5wcm9wZXJ0aWVzLkxHQV9DT0RFMTkpIHsKICAgICAgICAgICAgICAgICBjb25zdCBudW1iZXJPZkNhc2VzQnlMZ2EgPSBfLmZpbmQodGhpcy5kYWlseUNhc2VzSW5TdGF0ZSwge2xnYV9jb2RlOiBmZWF0dXJlLnByb3BlcnRpZXMuTEdBX0NPREUxOX0pOwoKICAgICAgICAgICAgICAgIGlmIChudW1iZXJPZkNhc2VzQnlMZ2EpIHsKICAgICAgICAgICAgICAgICAgICBsYXllci5iaW5kUG9wdXAoYCR7ZmVhdHVyZS5wcm9wZXJ0aWVzLkxHQV9OQU1FMTkuYm9sZCgpfSwgVG90YWwgY2FzZXM6ICR7bnVtYmVyT2ZDYXNlc0J5TGdhLnRvdGFsX2Nhc2VzfWApOwogICAgICAgICAgICAgICAgICAgIGxheWVyLm9uKCdtb3VzZW92ZXInLCAoKSA9PiB7IGxheWVyLm9wZW5Qb3B1cCgpOyB9KTsKICAgICAgICAgICAgICAgICAgICBsYXllci5vbignbW91c2VvdXQnLCAoKSA9PiB7IGxheWVyLmNsb3NlUG9wdXAoKTsgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGFkZExlZ2VuZChtYXBEaXYpIHsKICAgICAgICAgICAgY29uc3QgbGVnZW5kID0gTC5jb250cm9sKHtwb3NpdGlvbjogJ2JvdHRvbXJpZ2h0J30pOwoKICAgICAgICAgICAgbGVnZW5kLm9uQWRkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgY29uc3QgZGl2ID0gTC5Eb21VdGlsLmNyZWF0ZSgnZGl2JywgJ2luZm8gbGVnZW5kJyk7CiAgICAgICAgICAgICAgICBjb25zdCBncmFkZXMgPSBbMSwgMTAsIDUwLCAxMDAsIDUwMCwgMTAwMF07CiAgICAgICAgICAgICAgICBjb25zdCBsYWJlbHMgPSBbJzxzdHJvbmc+TnVtYmVyIG9mIENhc2VzPC9zdHJvbmc+PGJyPiddOwogICAgICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgLy8gbG9vcCB0aHJvdWdoIGRlbnNpdHkgaW50ZXJ2YWxzIGFuZCBnZW5lcmF0ZSBhIGxhYmVsIHdpdGggYSBjb2xvcmVkIHNxdWFyZSBmb3IgZWFjaCBpbnRlcnZhbAogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBncmFkZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgKz0KICAgICAgICAgICAgICAgIGxhYmVscy5wdXNoKAogICAgICAgICAgICAgICAgICAgICc8aSBjbGFzcz0iY2lyY2xlIiBzdHlsZT0iYmFja2dyb3VuZDonICsgZ2V0Q29sb3IoZ3JhZGVzW2ldICsgMSkgKyAnIj48L2k+ICcgKwogICAgICAgICAgICBncmFkZXNbaV0gKyAoZ3JhZGVzW2kgKyAxXSA/ICcmbmRhc2g7JyArIGdyYWRlc1tpICsgMV0gKyAnPGJyPicgOiAnKycpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSBsYWJlbHMuam9pbignPGJyPicpOwogICAgICAgICAgICAgICAgcmV0dXJuIGRpdjsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgbGVnZW5kLmFkZFRvKG1hcERpdik7CiAgICAgICAgfSwKICAgICAgICBzZXR1cExlYWZsZXRNYXA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY29uc3QgbWFwRGl2ID0gTC5tYXAoIm1hcENvbnRhaW5lciIpLnNldFZpZXcodGhpcy5jZW50ZXIsIDgpOwogICAgICAgICAgICBMLnRpbGVMYXllcigKICAgICAgICAgICAgICAgICJodHRwczovL2FwaS5tYXBib3guY29tL3N0eWxlcy92MS9tb2FieWFyaS9ja3RiaXJicXAybTd2MTdvNTBncHdlNXg2L3RpbGVzL3t6fS97eH0ve3l9P2FjY2Vzc190b2tlbj17YWNjZXNzVG9rZW59IiwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjoKICAgICAgICAgICAgICAgICAgICAnTWFwIGRhdGEgKGMpIDxhIGhyZWY9Imh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnLyI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzLCA8YSBocmVmPSJodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktc2EvMi4wLyI+Q0MtQlktU0E8L2E+LCBJbWFnZXJ5IChjKSA8YSBocmVmPSJodHRwczovL3d3dy5tYXBib3guY29tLyI+TWFwYm94PC9hPicsCiAgICAgICAgICAgICAgICAgICAgbWF4Wm9vbTogMTYsCiAgICAgICAgICAgICAgICAgICAgbWluWm9vbTogNiwKICAgICAgICAgICAgICAgICAgICBpZDogIm1hcGJveC9zdHJlZXRzLXYxMSIsCiAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46ICJYWFgiLAogICAgICAgICAgICAgICAgfSkuYWRkVG8obWFwRGl2KTsKCiAgICAgICAgICAgIEwuZ2VvSnNvbih0aGlzLk5TV0dlb0pzb24sIHtvbkVhY2hGZWF0dXJlOiB0aGlzLm9uRWFjaEZlYXR1cmUsIHN0eWxlOiB0aGlzLnN0eWxlTWFwfSkuYWRkVG8obWFwRGl2KTsKICAgICAgICAgICAgcmV0dXJuIG1hcERpdjsKICAgICAgICB9LAogICAgfSwKICAgIGFzeW5jIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy5OU1dHZW9Kc29uID0gYXdhaXQgYXBpLmdldE5TV0dlb0pzb24oKTsKICAgICAgICB0aGlzLmRhaWx5Q2FzZXNJblN0YXRlID0gXy51bmlxQnkoYXdhaXQgYXBpLmdldENhc2VzSW5TdGF0ZSgpLCAnbGdhX2NvZGUnKTsKICAgICAgICBjb25zdCBtYXBEaXYgPSB0aGlzLnNldHVwTGVhZmxldE1hcCgpOwogICAgICAgIHRoaXMuc3R5bGVNYXAoKTsKICAgICAgICB0aGlzLmFkZExlZ2VuZChtYXBEaXYpCiAgICB9Cn07Cg=="},{"version":3,"sources":["LeafletMap.vue"],"names":[],"mappings":";;;;;;;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LeafletMap.vue","sourceRoot":"src/components","sourcesContent":["<template>\n <div id=\"container\">\n     <h2>Map of NSW COVID-19 case locations</h2>\n   <div id=\"mapContainer\"></div>\n </div>\n</template>\n\n<script>\nimport \"leaflet/dist/leaflet.css\";\nimport { api } from '../helpers/helpers';\nimport L from \"leaflet\";\nimport _ from 'lodash';\nconst getColor = (d) => {\n                return  d > 1000 ? '#3D2807' :\n                        d > 500  ? '#bd0026' :\n                        d > 100  ? '#fb6a4a' :\n                        d > 50   ? '#fe9929' :\n                        d > 9   ?   'yellow' :\n                                    '#f0f0f0';\n        };\n\nexport default {\n    name: \"Map\",\n    data() {\n        return{\n            NSWGeoJson: [],\n            dailyCasesInState: [],\n            center: [-33.8555, 151.1155],\n        }\n    },\n    methods: {\n        getColor(d) {\n                return  d > 1000 ? '#3D2807' :\n                        d > 500  ? '#bd0026' :\n                        d > 100  ? '#fb6a4a' :\n                        d > 50   ? '#fe9929' :\n                        d > 10   ?   'yellow' :\n                                    '#f0f0f0';\n        },\n        styleMap(feature){\n            if (feature?.properties.LGA_CODE19) {\n                const lgaCode = feature.properties.LGA_CODE19;\n                const numberOfCasesByLga = _.find(this.dailyCasesInState, {lga_code: lgaCode});\n            \n                const totalCases = numberOfCasesByLga?.total_cases || 0;\n                const color = this.getColor(totalCases);\n                return { \n                    color: \"black\",\n                    fillColor: color,\n                    weight: 1,\n                    // opacity: 0.5,\n                    fillOpacity: 1\n                };\n            } else {\n                return { color: \"white\" };\n            }\n        },\n        onEachFeature(feature, layer) {\n            if (feature?.properties.LGA_CODE19) {\n                 const numberOfCasesByLga = _.find(this.dailyCasesInState, {lga_code: feature.properties.LGA_CODE19});\n\n                if (numberOfCasesByLga) {\n                    layer.bindPopup(`${feature.properties.LGA_NAME19.bold()}, Total cases: ${numberOfCasesByLga.total_cases}`);\n                    layer.on('mouseover', () => { layer.openPopup(); });\n                    layer.on('mouseout', () => { layer.closePopup(); });\n                }\n            }\n        },\n        addLegend(mapDiv) {\n            const legend = L.control({position: 'bottomright'});\n\n            legend.onAdd = function () {\n                const div = L.DomUtil.create('div', 'info legend');\n                const grades = [1, 10, 50, 100, 500, 1000];\n                const labels = ['<strong>Number of Cases</strong><br>'];\n                \n\n                // loop through density intervals and generate a label with a colored square for each interval\n                for (let i = 0; i < grades.length; i++) {\n                div.innerHTML +=\n                labels.push(\n                    '<i class=\"circle\" style=\"background:' + getColor(grades[i] + 1) + '\"></i> ' +\n            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+'));\n                }\n                div.innerHTML = labels.join('<br>');\n                return div;\n            };\n            legend.addTo(mapDiv);\n        },\n        setupLeafletMap: function () {\n            const mapDiv = L.map(\"mapContainer\").setView(this.center, 8);\n            L.tileLayer(\n                \"https://api.mapbox.com/styles/v1/moabyari/cktbirbqp2m7v17o50gpwe5x6/tiles/{z}/{x}/{y}?access_token={accessToken}\",\n                {\n                    attribution:\n                    'Map data (c) <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery (c) <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n                    maxZoom: 16,\n                    minZoom: 6,\n                    id: \"mapbox/streets-v11\",\n                    accessToken: \"XXX\",\n                }).addTo(mapDiv);\n\n            L.geoJson(this.NSWGeoJson, {onEachFeature: this.onEachFeature, style: this.styleMap}).addTo(mapDiv);\n            return mapDiv;\n        },\n    },\n    async mounted() {\n        this.NSWGeoJson = await api.getNSWGeoJson();\n        this.dailyCasesInState = _.uniqBy(await api.getCasesInState(), 'lga_code');\n        const mapDiv = this.setupLeafletMap();\n        this.styleMap();\n        this.addLegend(mapDiv)\n    }\n};\n</script>\n\n<style>\n    #mapContainer {\n        /* width: 300px; */\n        height: 90vh;\n        margin: 0 auto;\n    }\n\n    #container {\n        padding: 0 29px 29px 29px;\n    }\n\n    #container h2 {\n        font-size: 21px;\n        text-align: center;\n    }\n\n    .legend {\n        line-height: 18px;\n        color: rgb(35, 29, 29);\n        background-color: rgb(255, 255, 255, 0.45);\n        padding: 5px 10px;\n        border-radius: 3%;\n    }\n\n    .circle {\n        width: 18px;\n        height: 18px;\n        float: left;\n        margin-right: 8px;\n        opacity: 1;\n        border-radius: 50%;\n    }   \n</style>"]}]}